# USearch 课程测验题

本测验涵盖所有14天的课程内容，用于检验学习效果。

## 第1天：USearch 概览和环境搭建

### 1. USearch 的核心特性是什么？

A. 支持超过100种语言绑定
B. 单文件头文件库设计
C. 必须依赖 SimSIMD
D. 只支持 Linux 平台

**答案**: B

### 2. 以下哪个不是 USearch 支持的标量类型？

A. f32
B. f16
C. i16
D. i8

**答案**: C (USearch 不支持 i16，支持 i8)

### 3. USearch 的三层架构中，哪一层最接近用户代码？

A. 核心层 (index.hpp)
B. 接口层 (index_dense.hpp)
C. 语言绑定层
D. 硬件抽象层

**答案**: C

---

## 第2天：HNSW 算法基础理论

### 1. HNSW 中的 "H" 代表什么？

A. High
B. Hash
C. Hierarchical
D. Hybrid

**答案**: C

### 2. 节点的层级是如何确定的？

A. 固定为 3 层
B. 均匀随机分布
C. 指数分布随机采样
D. 根据向量维度决定

**答案**: C

### 3. HNSW 搜索的时间复杂度是？

A. O(N)
B. O(log N)
C. O(N log N)
D. O(√N)

**答案**: B

### 4. 假设 ml = 0.5，一个节点出现在第 2 层的概率是多少？

A. 25%
B. 12.5%
C. 50%
D. 6.25%

**答案**: B (P(level >= 2) = 0.5^(-2) = 0.25，P(level == 2) = P(level >= 2) - P(level >= 3) = 0.25 - 0.125 = 0.125)

---

## 第3天：核心数据结构设计

### 1. `compressed_slot_t` 的类型通常是？

A. std::uint16_t
B. std::uint32_t
C. std::uint64_t
D. std::size_t

**答案**: B

### 2. 为什么使用 `misaligned_load` 而不是直接指针转换？

A. 为了加密数据
B. 为了处理未对齐的内存访问
C. 为了提高性能
D. 为了减少内存占用

**答案**: B

### 3. `bitset_gt` 相比 `std::vector<bool>` 的主要优势是？

A. 功能更丰富
B. 更容易使用
C. 更高的缓存命中率和更快的操作
D. 支持动态大小

**答案**: C

### 4. 节点头部 (`node_head_bytes_`) 的大小是多少？

A. 8 字节
B. 16 字节
C. 24 字节
D. 32 字节

**答案**: B (sizeof(vector_key_t) + sizeof(level_t) = 8 + 2，填充到 16 字节)

---

## 第4天：向量索引实现

### 1. `index_dense_gt` 相比 `index_gt` 的主要优势是？

A. 支持更多度量
B. 自动管理向量存储
C. 更快的搜索速度
D. 更小的内存占用

**答案**: B

### 2. 索引头部的总大小是？

A. 32 字节
B. 64 字节
C. 128 字节
D. 256 字节

**答案**: B

### 3. 多向量 (multi-vector) 功能中，距离聚合的默认策略是？

A. 最小值
B. 最大值
C. 平均值
D. 加权平均

**答案**: B (max 策略)

### 4. 768 维 f32 向量的 100 万个向量需要多少内存？

A. ~300 MB
B. ~3 GB
C. ~30 GB
D. ~10 GB

**答案**: B (768 * 4 * 1,000,000 = 3,072,000,000 bytes ≈ 3 GB)

---

## 第5天：距离计算系统

### 1. 以下哪个度量不满足三角不等式？

A. L2 距离
B. 余弦相似度
C. 汉明距离
D. Jaccard 距离

**答案**: B (余弦是相似度，不是距离度量)

### 2. 余弦相似度的范围是？

A. [0, 1]
B. [-1, 1]
C. [0, ∞]
D. (-∞, ∞)

**答案**: B

### 3. USearch 中如何加速距离计算？

A. 使用 GPU
B. SIMD 指令集
C. 多线程
D. 以上都是

**答案**: D

### 4. Haversine 距离主要用于？

A. 文本相似度
B. 地理坐标距离
C. 图像特征
D. 音频特征

**答案**: B

---

## 第6天：搜索算法详解

### 1. Beam Search 中维护的两个优先队列分别用于？

A. 最小堆和最小堆
B. 最大堆和最大堆
C. 最小堆和最大堆
D. 最小堆和排序数组

**答案**: C

### 2. ef 参数的主要影响是？

A. 内存占用
B. 搜索精度
C. 构建速度
D. 以上都是

**答案**: D

### 3. 高层搜索使用什么算法？

A. Beam Search
B. 贪婪搜索
C. 暴力搜索
D. 二分搜索

**答案**: B

### 4. 如果要求 99% 的召回率，ef 应该设置为？

A. 16
B. 64
C. 128
D. 256

**答案**: D (或 C，取决于数据集)

---

## 第7天：插入算法详解

### 1. 邻居选择的启发式算法的主要目的是？

A. 加速选择
B. 避免选择密集的邻居
C. 减少内存使用
D. 提高构建速度

**答案**: B

### 2. 动态剪枝的触发条件是？

A. 节点被删除
B. 邻居数超过上限
C. 新节点插入
D. 搜索半径过大

**答案**: B

### 3. 并发插入时，USearch 使用什么锁策略？

A. 全局锁
B. 层级锁
C. 节点级锁
D. 无锁

**答案**: C

### 4. 如果 `ml = 1/ln(16)`，期望的平均层数是多少？

A. ln(16)
B. 1/ln(16)
C. log₂(16)
D. 16

**答案**: A (平均层数 = 1/ml = ln(16))

---

## 第8天：内存管理机制

### 1. Tape 分配器的主要优势是？

A. 支持任意大小分配
B. 连续内存布局
C. 自动垃圾回收
D. 线程安全

**答案**: B

### 2. 内存映射文件的主要优势是？

A. 更快的加载速度
B. 零拷贝访问
C. 更小的文件大小
D. 自动压缩

**答案**: B

### 3. USearch 中缓存行对齐到多少字节？

A. 32
B. 64
C. 128
D. 256

**答案**: B

### 4. 零拷贝操作的主要风险是？

A. 性能下降
B. 生命周期管理
C. 内存泄漏
D. 线程不安全

**答案**: B

---

## 第9天：SIMD 优化和硬件加速

### 1. AVX2 指令集可以同时处理多少个 f32 数？

A. 4
B. 8
C. 16
D. 32

**答案**: B (256 bit / 32 bit = 8)

### 2. SimSIMD 库的主要作用是？

A. 自动并行化
B. 提供跨平台的 SIMD 内核
C. 优化编译选项
D. 管理内存

**答案**: B

### 3. FMA 指令的全称是？

A. Fast Memory Access
B. Fused Multiply-Add
C. Function Mapping Architecture
D. First Memory Allocation

**答案**: B

### 4. 相比标量代码，AVX2 理论上可以加速多少倍？

A. 2x
B. 4x
C. 8x
D. 16x

**答案**: C (在理想情况下)

---

## 第10天：并行化和并发控制

### 1. USearch 使用的并行化技术主要是？

A. MPI
B. OpenMP
C. CUDA
D. OpenCL

**答案**: B

### 2. 节点锁采用的是什么类型的锁？

A. 互斥锁
B. 自旋锁
C. 读写锁
D. 递归锁

**答案**: B

### 3. 无锁数据结构的核心原语是？

A. 互斥锁
B. CAS (Compare-And-Swap)
C. 信号量
D. 条件变量

**答案**: B

### 4. 批量搜索时，理想的加速比是？

A. 线性于线程数
B. 线性于核心数
C. 对数于线程数
D. 常数

**答案**: A (理想情况下)

---

## 第11天：量化和压缩技术

### 1. BF16 相比 F16 的主要优势是？

A. 更小的内存占用
B. 与 f32 相同的指数范围
C. 更高的精度
D. 更快的计算速度

**答案**: B

### 2. f32 → f16 量化的内存节省比例是？

A. 25%
B. 50%
C. 75%
D. 87.5%

**答案**: B

### 3. 乘积量化 (PQ) 将向量分成多少段？

A. 固定 8 段
B. 可配置，通常 4-16 段
C. 根据维度决定
D. 随机分段

**答案**: B

### 4. 二值量化 (b1x8) 相比 f32 的压缩比是？

A. 8x
B. 16x
C. 32x
D. 64x

**答案**: C

---

## 第12天：序列化和持久化

### 1. USearch 索引文件的魔数是？

A. "HNSW"
B. "usearch"
C. "INDEX"
D. "VECTOR"

**答案**: B

### 2. 索引头部的大小是？

A. 32 字节
B. 64 字节
C. 128 字节
D. 可变

**答案**: B

### 3. 内存映射加载相比完全加载的主要优势是？

A. 更快的搜索速度
B. 更小的内存占用
C. 即时启动
D. 更好的并发性能

**答案**: C

### 4. USearch 字节序采用？

A. 大端序
B. 小端序
C. 网络字节序
D. 平台相关

**答案**: B

---

## 第13天：性能优化技巧

### 1. 缓存行对齐的主要目的是？

A. 减少内存占用
B. 避免伪共享
C. 提高对齐速度
D. 简化代码

**答案**: B

### 2. 软件预取的最佳距离是？

A. 固定 1
B. 固定 4
C. 根据硬件自适应
D. 不需要预取

**答案**: C

### 3. 分支预测优化中，`__builtin_expect` 的作用是？

A. 消除分支
B. 提示编译器分支方向
C. 自动优化分支
D. 统计分支行为

**答案**: B

### 4. 三角不等式剪枝可以减少？

A. 内存使用
B. 距离计算次数
C. 图边数
D. 索引大小

**答案**: B

---

## 第14天：综合案例和最佳实践

### 1. RAG 系统中，向量搜索的主要作用是？

A. 生成文本
B. 检索相关文档
C. 训练模型
D. 压缩数据

**答案**: B

### 2. 图像特征提取通常使用什么模型？

A. ResNet
B. BERT
C. GPT
D. LSTM

**答案**: A

### 3. 推荐系统中，通常使用什么距离度量？

A. 余弦相似度
B. L2 距离
C. 内积
D. 汉明距离

**答案**: C

### 4. 生产环境中，最重要的监控指标是？

A. 代码行数
B. 搜索延迟和召回率
C. 编译时间
D. 文件数量

**答案**: B

---

## 综合测试

### 1. 以下哪些是 USearch 的设计原则？（多选）

A. 单文件设计
B. 必须使用 GPU
C. 硬件无关性
D. 只支持 Linux

**答案**: A, C

### 2. HNSW 算法的优势包括？（多选）

A. 对数时间复杂度
B. 高召回率
C. 支持动态插入
D. 零内存占用

**答案**: A, B, C

### 3. 性能优化的层次包括？（多选）

A. 算法层面
B. 数据结构层面
C. 硬件层面
D. 系统层面

**答案**: A, B, C, D

### 4. 量化技术可以带来？（多选）

A. 内存节省
B. 搜索加速
C. 精度提升
D. 跨平台兼容

**答案**: A, B

---

## 评分标准

- **优秀**: 80-100 分
- **良好**: 60-79 分
- **及格**: 40-59 分
- **需要重学**: < 40 分

## 建议

完成测验后，请：
1. 复习错题对应的知识点
2. 重读相关章节
3. 运行示例代码加深理解
4. 完成实战练习

祝学习愉快！
